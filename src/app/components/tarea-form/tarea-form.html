<div class="container pb-5">
  <div class="card custom-card p-4 mx-auto" style="max-width: 800px;">

    <h5 class="mb-4 fw-bold pb-2 border-bottom" style="color: #455a64;">
      {{ esEdicion ? 'Editar Proyecto' : 'Nuevo Proyecto' }}
    </h5>

    <form (ngSubmit)="guardar()">

      <div class="mb-4">
        <label class="form-label small text-secondary fw-bold">TÍTULO</label>
        <input type="text" class="form-control bg-light border-0 py-2"
               name="titulo" [(ngModel)]="tarea.titulo"
               required placeholder="Ej: Estudiar Annotations">
      </div>

      <div class="mb-4">
        <label class="form-label small text-secondary fw-bold">DESCRIPCIÓN</label>
        <textarea class="form-control bg-light border-0 py-2" name="descripcion"
                  [(ngModel)]="tarea.descripcion" rows="3"
                  placeholder="Notas adicionales..."></textarea>
      </div>

      <div class="mb-4 mt-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <label class="form-label small text-secondary fw-bold mb-0">PASOS A SEGUIR</label>
          <button type="button" class="btn btn-sm btn-outline-secondary rounded-pill px-3" (click)="agregarPaso()">
            + Agregar paso
          </button>
        </div>

        @for (paso of tarea.pasos; track $index) {
          <div class="d-flex align-items-center mb-2 p-2 rounded hover-bg">
            <input class="form-check-input me-3" type="checkbox"
                   [(ngModel)]="paso.completado" [name]="'check'+$index">

            <input type="text" class="form-control form-control-sm border-0 bg-transparent border-bottom rounded-0 text-secondary"
                   placeholder="Describe el paso..."
                   [name]="'desc'+$index" [(ngModel)]="paso.descripcion" required>

            <button class="btn btn-link text-secondary text-decoration-none px-2 opacity-50 hover-opacity-100"
                    type="button" (click)="eliminarPaso($index)">
              ✕
            </button>
          </div>
        } @empty {
          <div class="text-center p-3 text-muted fst-italic border rounded-3 bg-light">
            <small>Añade pasos para desglosar esta tarea</small>
          </div>
        }
      </div>

      <div class="d-flex justify-content-end gap-2 mt-5 pt-3 border-top">
        <button routerLink="/tareas" class="btn btn-link text-secondary text-decoration-none">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary px-4 fw-bold shadow-sm">
          Guardar Tarea
        </button>
      </div>

    </form>
  </div>
</div>
